<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Criar um sistema de gerenciamento de usuários. Para isso voce precisa realizar o seguinte processo:</title>
</head>

<body>
    <script>

        // variavel com logica booleana para o loop while, fazer enquanto opção for verdadeira
        let loopBreak = true
        // Precisa criar o array escopo global para armazenar as variaveis nome, numero telefone 
        let arrayUsuarios = []

        // Inicio da função para data no padrão Brasil
        // *********************************************************************************************************************************************************

        function formatarDataBrasileira(data) {
            // Obtém os componentes da data
            let dia = data.getDate().toString().padStart(2, '0');
            let mes = (data.getMonth() + 1).toString().padStart(2, '0'); // Mês é base 0, pois é um array e começa na posição 0 então adicionamos 1
            let ano = data.getFullYear();

            // Formata a data no formato brasileiro
            return `${dia}/${mes}/${ano}`;
        }

        // Cria um objeto Date com a data atual
        let data = new Date();

        // Formata a data no formato brasileiro
        let dataFormatada = formatarDataBrasileira(data);

        // Exibe a data formatada no console
        // alert(`Data: ${dataFormatada}`);


        // *********************************************************************************************************************************************************
        // Fim da função da função data no padrão Brasil


        // Entrada de dados
        // Criação de um menu com as 4 operações que o usuário pode realizar (Cadastrar, listar, atualizar, deletar)

        // Este looping funciona enquanto a variavel loopBreak fou verdadeira
        while (loopBreak) {
            // realizar a criação dos métodos com switch case para validar as opções do usuário
            let opcaoUsuario = parseInt(prompt(`
            
            Escolha uma opção abaixo
            *******************************
            [ 1 ] - Cadastrar usuário...
            [ 2 ] - Listagem de usuários...
            [ 3 ] - Atualizar cadastro de usuários...
            [ 4 ] - Excluir cadastro...
            [ 5 ] - Sair do sistema
            `))

            switch (opcaoUsuario) {
                case 1:

                    // Quando realizar o cadastro do usuário, realizar também a data de cadastro do usuário (quando ele foi criado) e exibir o usuário, o email e a data que o usuário foi criado
                    // Cadastro: Nome, email e senha


                    let nomeUsuario = prompt("Informar o nome do usuário: ")
                    let cadEmail = prompt("Informe o email do usuário:    ")
                    let CadSenha = prompt("Informe a senha do usuário")
                    alert(`Data: ${dataFormatada} Usuário: ${nomeUsuario} E-Mail: ${cadEmail} Senha: ${CadSenha}`);

                    // Método do array PUSH para acrescentar o usuário, email e senha no ARRAYUSUARIOS
                    arrayUsuarios.push({ dataFormatada, nomeUsuario, cadEmail, CadSenha })

                    // Alerta apos o cadastro ter sido cadastrado
                    console.log(arrayUsuarios);

                    alert('Usuário cadastrado com sucesso! ')


                    break;
                case 2:
                    // Listagem: Data de criação(atual), nome, email e senha
                    // Listagem dos usuéios cadastrados no arrayusuarios

                    let listaDeUsuarios = "Lista de usuários: \n";  // Inicia a variavel e o \n para ir na linha abaixo

                    // Criar um for simples com uma variavel para percorre todo o arrayusuarios
                    for (listaArray of arrayUsuarios) {

                        // Criar uma variavel para receber a lista de arrayusuarios 
                        // Utilizar operador unário += é um incrementador
                        // Listagem: Data de criação(atual), nome, email e senha
                        listaDeUsuarios += `Data: ${listaArray.dataFormatada}, Nome do usuários: ${listaArray.nomeUsuario}, E-mail: ${listaArray.cadEmail}, Senha: ${listaArray.CadSenha}\n` // \n para ir na linha de baixo
                    }


                    // visualizar a lista de usuarios
                    alert(listaDeUsuarios)


                    break;
                case 3:
                    // atualizar: com base no email e senha
                    // Realizar metodo de atualização dos dados do gerenciador de usuarios
                    // Precisa especificar um arrray principal o email e a senha ficou com principal 
                    let emailAtualizar = prompt("Informe o e-mail do usuário: ");
                    let senhaAtualizar = prompt("Informe a senha do usuário: ");

                    // variavel para verificar se a informação informada é verdadeira 
                    // Uma condição ternário
                    //                                     Variavel buscaArray
                    let usuarioBuscado = arrayUsuarios.find(buscaArray => buscaArray.cadEmail === emailAtualizar && buscaArray.CadSenha === senhaAtualizar)
                    if (usuarioBuscado) {
                        usuarioBuscado.cadEmail = prompt("Informe o novo e-mail: ");
                        usuarioBuscado.CadSenha = prompt("Informe a nova senha: ");


                    } else {
                        // Se for falso
                        alert("Nenhum usuário foi encontrado")
                    }



                    break;
                case 4:

                    // excluir: com base no email
                    // encontrar o usuário a ser deletado
                    let usuarioExcluir = prompt("Informe o email do usuário a ser excluido: ");
                    //                                               variavel para excluir 
                    let usuarioParaExcluir = arrayUsuarios.findIndex(excluirCadastro => excluirCadastro.
                    cadEmail === usuarioExcluir)
                    // === é estritamente igual

                    // realizar a comparação foi colocado diferente -1, para verificar na posição anterior do array
                    if (usuarioParaExcluir !== -1) {

                        // Irá localizar o nome se tiver dentro o array ira excluir
                        alert("Usuário excluído com sucesso!!")
                        
                        //                 nome         quantidade 1
                        arrayUsuarios.splice(usuarioParaExcluir, 1)



                    } else {
                        alert("Nenhum usuário foi encontrado")
                    }



                    break;
                case 5:
                    // Para sair do sistema
                    alert("Obrigado por utilizar o sistema de gerenciamento do Perdigão, até mais...");
                    loopBreak = false


                    break;

                default:
                    alert("Opção Inválida")
                    // Invocar função para finalizar o processo
                    process.exit()
                    break;
            }


        }



    </script>
</body>

</html>
